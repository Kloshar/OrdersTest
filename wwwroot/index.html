<html>
<head>
    <meta chaset="utf-8"/>
</head>
<body>
    <div style="width:20px; height:20px; background:blue"></div>

    <script>
        "use strict";        
        async function getOrders() { //GET запрос на сервер
            const response = await fetch("/api/order", { method: "GET", headers: { "Accept": "application/json" } });
            if (response.ok === true) {
                const orders = await response.json(); //ожидаем json, получаем Array
                let table = document.createElement('table'); //создаЄм таблицу
                table.style.content = 'center';

                if (orders.length > 0) { //если в таблице есть заказы                    
                    table.appendChild(makeTableHeader(orders)); //создаЄм шапку таблицы дл€ вывода
                    table.border = 1;
                    table.cellSpacing = 0;
                    table.cellPadding = 5;
                    for (let i = 0; i < makeOrderRows(orders).length; i++) { //добавл€ем строки с запис€ми (заказами)
                        table.append(makeOrderRows(orders)[i]);
                    }
                    document.body.append(table);
                }                
            }
        }
        function makeTableHeader(ar) { //функци€ принимает массив объектов (заказов) и возвращает шапку таблицы с заголовками
            let row = document.createElement('tr');
            for (let key in ar[0]) { //перебираем ключи объекта первого элемента массива
                let cell = document.createElement('td');
                cell.textContent = key;
                cell.align = 'center';
                row.appendChild(cell);
            }
            //добавл€ем две пустых €чейки под кнопки
            let cell1 = document.createElement('td');
            row.appendChild(cell1);
            let cell2 = document.createElement('td');
            row.appendChild(cell2);
            return row;
        }
        function makeOrderRows(ar) { //функци€ принимает массив объектов (заказов) и возвращает строки с заказами
            let rows = new Array(); //массив дл€ строк

            for (let i = 0; i < ar.length; i++) {
                let row = document.createElement('tr'); //строка дл€ каждой записи
                for (let key in ar[i]) {
                    let cell = document.createElement('td'); //€чейка дл€ каждого пол€ аписи
                    cell.textContent = ar[i][key];
                    cell.align = 'center';
                    row.appendChild(cell);
                }
                //добавл€ем две кнопки
                let cell1 = document.createElement('td');
                let btnEdit = document.createElement('button');
                btnEdit.textContent = 'Edit';
                cell1.appendChild(btnEdit);
                row.appendChild(cell1);

                let cell2 = document.createElement('td');
                let btnDelete = document.createElement('button');
                btnDelete.textContent = 'Delete';
                cell2.appendChild(btnDelete);
                row.appendChild(cell2);

                rows[i] = row;
            }
            return rows;
        }
        getOrders(); //отправл€ем GET запрос на сервер
    </script>
</body>
</html>